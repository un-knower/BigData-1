案例描述与分析
在案例一中，我们将存储于 HDFS 中的文件转换成 DataFrame 并进行了一系列的统计，细心的读者会发现，都是一个关联于一个 DataFrame 的简单查询和统计，那么在案例二中，我们将向读者展示如何连接多个 DataFrame 做更复杂的统计分析。
在本案例中，我们将统计分析 1 千万用户和 1 亿条交易数据。对于用户数据，它是一个包含 6 个列 (ID, 性别, 年龄, 注册日期, 角色 (从事行业), 所在区域) 的文本文件，具有以下格式。
/**
  * 6 个列 (ID, 性别, 年龄, 注册日期, 角色 (从事行业), 所在区域) 的文本文件
  *
  * 1 F 21 2006-10-1 ROLE005 REG002
  * 2 F 30 2001-10-7 ROLE002 REG004
  * 3 M 43 2004-5-23 ROLE003 REG005
  * 4 F 13 2012-12-27 ROLE004 REG003
  * 5 M 14 2015-11-9 ROLE0001 REG002
  * 6 F 38 2004-2-19 ROLE003 REG001
  * 7 M 46 2004-9-20 ROLE003 REG003
  * 8 F 50 2005-9-15 ROLE003 REG003
  * 9 F 53 2009-5-16 ROLE005 REG003
  * 10 F 15 2005-7-1 ROLE003 REG001
  */

 对于交易数据，它是一个包含 5 个列 (交易单号, 交易日期, 产品种类, 价格, 用户 ID) 的文本文件，具有以下格式。
 /**
   * 对于交易数据，它是一个包含 5 个列 (交易单号, 交易日期, 产品种类, 价格, 用户 ID) 的文本文件，具有以下格式。
   * 1 2009-11-8 3 654 6948670
   * 2 2011-1-17 1 276 5108042
   * 3 2010-6-26 2 1655 6913938
   * 4 2014-8-13 6 79 4794762
   * 5 2002-7-24 4 1622 407646
   * 6 2004-12-25 6 385 433669
   * 7 2009-5-6 6 1883 7219755
   * 8 2000-3-7 2 1402 9939043
   * 9 2009-11-11 3 1256 8455746
   * 10 2004-10-12 10 744 7678877
   */